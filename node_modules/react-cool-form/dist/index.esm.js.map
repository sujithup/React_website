{"version":3,"file":"index.esm.js","sources":["../src/hooks/useLatest.ts","../src/utils/arrayToMap.ts","../src/utils/isObject.ts","../src/utils/isFileList.ts","../src/utils/cloneObject.ts","../src/utils/compact.ts","../src/utils/isPlainObject.ts","../src/utils/deepMerge.ts","../src/utils/isUndefined.ts","../src/utils/filterErrors.ts","../src/utils/stringToPath.ts","../src/utils/get.ts","../src/utils/getIsDirty.ts","../src/utils/isFunction.ts","../src/utils/isAsyncFunction.ts","../src/utils/isCheckboxInput.ts","../src/utils/isEmptyObject.ts","../src/utils/isFieldElement.ts","../src/utils/isFileInput.ts","../src/utils/isInputElement.ts","../src/utils/isMultipleSelect.ts","../src/utils/isNumberInput.ts","../src/utils/isRadioInput.ts","../src/utils/isRangeInput.ts","../src/utils/runWithLowPriority.ts","../src/utils/set.ts","../src/utils/unset.ts","../src/utils/warn.ts","../src/hooks/useState.ts","../src/hooks/useIsoLayoutEffect.ts","../src/useForm.ts"],"sourcesContent":["import { MutableRefObject, useRef, useEffect } from \"react\";\n\nexport default <T>(val: T): MutableRefObject<T> => {\n  const ref = useRef(val);\n\n  useEffect(() => {\n    ref.current = val;\n  });\n\n  return ref;\n};\n","import { Map } from \"../types\";\n\nexport default (arr: any[]): Map =>\n  arr.reduce((obj, key) => {\n    obj[key] = true;\n    return obj;\n  }, {});\n","export default (value: unknown): value is Object =>\n  value !== null && typeof value === \"object\";\n","export default (value: unknown): value is FileList => value instanceof FileList;\n","import isObject from \"./isObject\";\nimport isFileList from \"./isFileList\";\n\nconst cloneObject = (object: unknown): any => {\n  if (object instanceof Event) throw new Error(\"Unable to clone event.\");\n\n  if (!isObject(object) || isFileList(object)) return object;\n\n  if (object instanceof Date) return new Date(object.getTime());\n\n  if (Array.isArray(object)) return object.map((val) => cloneObject(val));\n\n  if (isObject(object))\n    return Object.keys(object).reduce((obj: Record<string, any>, key) => {\n      obj[key] = cloneObject((object as Record<string, any>)[key]);\n      return obj;\n    }, {});\n\n  throw new Error(\"Unable to clone object.\");\n};\n\nexport default cloneObject;\n","export default (arr: any[]): any[] => arr.filter(Boolean);\n","import isObject from \"./isObject\";\n\nexport default (value: unknown): value is Object =>\n  !Array.isArray(value) && !(value instanceof Date) && isObject(value);\n","import isPlainObject from \"./isPlainObject\";\n\nconst deepMerge = (...objects: any[]): any =>\n  objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const prevValue = prev[key];\n      const currValue = obj[key];\n\n      if (Array.isArray(prevValue) && Array.isArray(currValue)) {\n        prev[key] = [...prevValue, ...currValue];\n      } else if (isPlainObject(prevValue) && isPlainObject(currValue)) {\n        prev[key] = deepMerge(prevValue, currValue);\n      } else {\n        prev[key] = currValue;\n      }\n    });\n\n    return prev;\n  }, {});\n\nexport default deepMerge;\n","export default (value: unknown): value is undefined => value === undefined;\n","import isPlainObject from \"./isPlainObject\";\nimport isUndefined from \"./isUndefined\";\n\nconst filterErrors = (error: unknown, touched: unknown): any => {\n  if (!isPlainObject(error)) return touched ? error : undefined;\n\n  return Object.keys(error).reduce((obj: Record<string, any>, key) => {\n    const nextErrors = filterErrors(\n      (error as Record<string, any>)[key],\n      (touched as Record<string, any>)[key] || false\n    );\n\n    if (!isUndefined(nextErrors)) {\n      obj[key] = nextErrors;\n    } else {\n      delete obj[key];\n    }\n\n    return obj;\n  }, {});\n};\n\nexport default filterErrors;\n","import compact from \"./compact\";\n\nexport default (str: string): string[] => {\n  if (typeof str !== \"string\") throw new TypeError(\"Expected a string.\");\n  if (!str.length) return [];\n\n  return compact(str.split(/[.[\\]]+/));\n};\n","import isPlainObject from \"./isPlainObject\";\nimport isUndefined from \"./isUndefined\";\nimport stringToPath from \"./stringToPath\";\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport default (object: any, path: string, defaultValue?: unknown): any => {\n  if (!isPlainObject(object) || !path) return defaultValue;\n\n  const value = stringToPath(path).reduce(\n    (obj, key) => (obj || {})[key],\n    object\n  );\n\n  return isUndefined(value) ? defaultValue : value;\n};\n","import isPlainObject from \"./isPlainObject\";\n\nconst getIsDirty = (dirty: object): boolean => {\n  const search = (dty: object, found: any[] = []) => {\n    for (const val of Object.values(dty)) {\n      if (val === true) {\n        found.push(val);\n        return found;\n      }\n\n      if (isPlainObject(val)) search(val, found);\n    }\n\n    return found;\n  };\n\n  return !!search(dirty).length;\n};\n\nexport default getIsDirty;\n","export default (value: unknown): value is Function =>\n  typeof value === \"function\";\n","import isFunction from \"./isFunction\";\n\nexport default (value: unknown): value is Promise<any> =>\n  isFunction(value) && value.constructor.name === \"AsyncFunction\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"checkbox\";\n","import isPlainObject from \"./isPlainObject\";\n\nexport default (value: unknown): value is Record<string, never> =>\n  isPlainObject(value) && !Object.keys(value).length;\n","import { FieldElement } from \"../types\";\n\nexport default (element: HTMLElement): element is FieldElement =>\n  /INPUT|TEXTAREA|SELECT/.test(element.tagName);\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"file\";\n","export default (element: HTMLElement): element is HTMLInputElement =>\n  element.tagName === \"INPUT\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLSelectElement =>\n  field.type === \"select-multiple\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"number\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"radio\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"range\";\n","export default (callback: (args: any) => any): any =>\n  (\n    window.requestIdleCallback ||\n    ((cb) => {\n      const start = Date.now();\n      return setTimeout(\n        () =>\n          cb({\n            didTimeout: false,\n            timeRemaining: () => Math.max(0, 50 - (Date.now() - start)),\n          }),\n        1\n      );\n    })\n  )(callback, { timeout: 2000 });\n","import cloneObject from \"./cloneObject\";\nimport isPlainObject from \"./isPlainObject\";\nimport stringToPath from \"./stringToPath\";\n\nexport default (\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  object: any,\n  path: string,\n  value: unknown,\n  immutable = false\n): any => {\n  if (!isPlainObject(object)) throw new TypeError(\"Expected an object.\");\n\n  const segs = stringToPath(path);\n  const newObject = immutable ? cloneObject(object) : object;\n\n  segs.slice(0, -1).reduce((obj, key, idx) => {\n    const nextIsNumber = !Number.isNaN(Number(segs[idx + 1]));\n    if (isPlainObject(obj[key]) && !nextIsNumber) return obj[key];\n    obj[key] = nextIsNumber ? [] : {};\n    return obj[key];\n  }, newObject)[segs[segs.length - 1] || \"\"] = value;\n\n  return newObject;\n};\n","/* eslint-disable no-prototype-builtins */\n\nimport cloneObject from \"./cloneObject\";\nimport isPlainObject from \"./isPlainObject\";\nimport isObject from \"./isObject\";\nimport stringToPath from \"./stringToPath\";\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport default (object: any, path: string, immutable = false): any => {\n  if (!isPlainObject(object)) throw new TypeError(\"Expected an object.\");\n\n  const refObject = immutable ? cloneObject(object) : object;\n  const newObject = refObject;\n\n  if (newObject.hasOwnProperty(path)) {\n    delete newObject[path];\n    return refObject;\n  }\n\n  const segs = stringToPath(path);\n\n  if (!segs.length) return refObject;\n\n  const last = segs.pop() as string;\n  const target = segs.reduce((obj, key) => (obj || {})[key], newObject);\n\n  if (isObject(target) && target.hasOwnProperty(last)) delete target[last];\n\n  return refObject;\n};\n","export default (...args: any[]): void => {\n  if (__DEV__) console.warn(...args);\n};\n","import { useReducer, useRef, useCallback } from \"react\";\nimport { dequal } from \"dequal/lite\";\n\nimport {\n  Debug,\n  FormState,\n  FormStateReturn,\n  Map,\n  SetStateRef,\n  SetUsedStateRef,\n} from \"../types\";\nimport useLatest from \"./useLatest\";\nimport { get, getIsDirty, isEmptyObject, set } from \"../utils\";\n\nexport default <V>(\n  initialState: FormState<V>,\n  onChange?: Debug<V>\n): FormStateReturn<V> => {\n  const [, forceUpdate] = useReducer((c) => c + 1, 0);\n  const stateRef = useRef(initialState);\n  const usedStateRef = useRef<Map>({});\n  const onChangeRef = useLatest(onChange || (() => undefined));\n\n  const setStateRef = useCallback<SetStateRef>(\n    (path, value, { fieldPath, shouldUpdate = true } = {}) => {\n      const key = path.split(\".\")[0];\n\n      if (!key) {\n        if (!dequal(stateRef.current, value)) {\n          stateRef.current = value;\n          forceUpdate();\n          onChangeRef.current(stateRef.current);\n        }\n\n        return;\n      }\n\n      if (\n        (path !== \"values\" && key === \"values\") ||\n        !dequal(get(stateRef.current, path), value)\n      ) {\n        const state = set(stateRef.current, path, value, true);\n        const {\n          errors,\n          dirty,\n          isDirty: prevIsDirty,\n          isValid: prevIsValid,\n        } = state;\n        let { submitCount: prevSubmitCount } = state;\n        const isDirty = key === \"dirty\" ? getIsDirty(dirty) : prevIsDirty;\n        const isValid = key === \"errors\" ? isEmptyObject(errors) : prevIsValid;\n        const submitCount =\n          key === \"isSubmitting\" && value\n            ? (prevSubmitCount += 1)\n            : prevSubmitCount;\n\n        stateRef.current = { ...state, isDirty, isValid, submitCount };\n\n        path = fieldPath || path;\n\n        if (\n          shouldUpdate &&\n          (Object.keys(usedStateRef.current).some(\n            (k) => path.startsWith(k) || k.startsWith(path)\n          ) ||\n            (usedStateRef.current.isDirty && isDirty !== prevIsDirty) ||\n            (usedStateRef.current.isValid && isValid !== prevIsValid))\n        ) {\n          forceUpdate();\n          onChangeRef.current(stateRef.current);\n        }\n      }\n    },\n    [onChangeRef]\n  );\n\n  const setUsedStateRef = useCallback<SetUsedStateRef>(\n    (path, unset = false) => {\n      if (unset) {\n        delete usedStateRef.current[path];\n      } else {\n        usedStateRef.current[path] = true;\n      }\n    },\n    []\n  );\n\n  return { stateRef, setStateRef, setUsedStateRef };\n};\n","import { useEffect, useLayoutEffect } from \"react\";\n\nconst useIsoLayoutEffect =\n  typeof window === \"undefined\" ? useEffect : useLayoutEffect;\n\nexport default useIsoLayoutEffect;\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport { useCallback, useEffect, useRef } from \"react\";\n\nimport {\n  ClearErrors,\n  Config,\n  Controller,\n  FieldArgs,\n  FieldElement,\n  FieldRef,\n  Fields,\n  FieldValidator,\n  FieldsValue,\n  FormErrors,\n  FormState,\n  FormValues,\n  GetState,\n  Map,\n  Reset,\n  Return,\n  RunValidation,\n  SetDirty,\n  SetError,\n  SetTouched,\n  SetValue,\n  Submit,\n} from \"./types\";\nimport { useIsoLayoutEffect, useLatest, useState } from \"./hooks\";\nimport {\n  arrayToMap,\n  compact,\n  deepMerge,\n  filterErrors,\n  get,\n  isAsyncFunction,\n  isCheckboxInput,\n  isEmptyObject,\n  isFieldElement,\n  isFileInput,\n  isFileList,\n  isFunction,\n  isInputElement,\n  isMultipleSelect,\n  isNumberInput,\n  isPlainObject,\n  isRadioInput,\n  isRangeInput,\n  isUndefined,\n  runWithLowPriority,\n  set,\n  unset,\n  warn,\n} from \"./utils\";\n\nexport default <V extends FormValues = FormValues>({\n  defaultValues = {} as V,\n  validate,\n  validateOnChange = true,\n  validateOnBlur = true,\n  builtInValidationMode = \"message\",\n  shouldRemoveField = true,\n  excludeFields = [],\n  onReset,\n  onSubmit,\n  onError,\n  debug,\n}: Config<V> = {}): Return<V> => {\n  const isInitRef = useRef(true);\n  const formRef = useRef<HTMLFormElement>(null);\n  const fieldsRef = useRef<Fields>({});\n  const fieldArgsRef = useRef<FieldArgs>({});\n  const controllersRef = useRef<Map>({});\n  const excludeFieldsRef = useRef<Map>(arrayToMap(excludeFields));\n  const changedFieldRef = useRef<string>();\n  const formValidatorRef = useLatest(validate);\n  const fieldValidatorsRef = useRef<Record<string, FieldValidator<V>>>({});\n  const onResetRef = useLatest(onReset || (() => undefined));\n  const onSubmitRef = useLatest(onSubmit || (() => undefined));\n  const onErrorRef = useLatest(onError || (() => undefined));\n  const defaultValuesRef = useRef(defaultValues);\n  const initialStateRef = useRef<FormState<V>>({\n    values: defaultValuesRef.current,\n    touched: {},\n    errors: {},\n    isDirty: false,\n    dirty: {},\n    isValidating: false,\n    isValid: true,\n    isSubmitting: false,\n    isSubmitted: false,\n    submitCount: 0,\n  });\n  const { stateRef, setStateRef, setUsedStateRef } = useState<V>(\n    initialStateRef.current,\n    debug\n  );\n\n  const getFields = useCallback(\n    (form: HTMLFormElement) =>\n      Array.from(form.querySelectorAll(\"input,textarea,select\"))\n        .filter((element) => {\n          const field = element as FieldElement;\n          const {\n            type,\n            name,\n            dataset: { rcfExclude },\n          } = field;\n\n          if (/button|image|submit|reset/.test(type)) return false;\n          if (rcfExclude && !name) {\n            warn('💡 react-cool-form > field: Missing the \"name\" attribute.');\n            return false;\n          }\n\n          return (\n            controllersRef.current[name] ||\n            !(rcfExclude || excludeFieldsRef.current[name])\n          );\n        })\n        .reduce((acc: Record<string, any>, cur) => {\n          const field = cur as FieldElement;\n          const { name } = field;\n\n          acc[name] = { ...acc[name], field: cur };\n\n          if (isCheckboxInput(field) || isRadioInput(field))\n            acc[name].options = acc[name].options\n              ? [...acc[name].options, cur]\n              : [cur];\n\n          return acc;\n        }, {}),\n    []\n  );\n\n  const handleUnset = useCallback(\n    (path: string, fieldPath: string, target: any, name: string) =>\n      setStateRef(path, unset(target, name, true), { fieldPath }),\n    [setStateRef]\n  );\n\n  const fieldRef = useCallback<FieldRef<V>>(\n    (validateOrOptions) => (field) => {\n      if (\n        !field?.name ||\n        controllersRef.current[field.name] ||\n        excludeFieldsRef.current[field.name]\n      )\n        return;\n\n      if (isFunction(validateOrOptions)) {\n        fieldValidatorsRef.current[field.name] = validateOrOptions;\n        return;\n      }\n\n      const { validate: validator, ...parsers } = validateOrOptions;\n\n      if (validator) fieldValidatorsRef.current[field.name] = validator;\n      fieldArgsRef.current[field.name] = parsers;\n    },\n    []\n  );\n\n  const getNodeValue = useCallback(\n    (name: string) => {\n      const { field, options } = fieldsRef.current[name];\n      let value = field.value as any;\n\n      if (isInputElement(field)) {\n        if (fieldArgsRef.current[name]?.valueAsNumber) {\n          value = field.valueAsNumber;\n          return value;\n        }\n        if (fieldArgsRef.current[name]?.valueAsDate) {\n          value = field.valueAsDate;\n          return value;\n        }\n      }\n\n      if (isNumberInput(field) || isRangeInput(field))\n        value = field.valueAsNumber || \"\";\n\n      if (isCheckboxInput(field)) {\n        if (options) {\n          const checkboxes = options as HTMLInputElement[];\n\n          if (options.length > 1) {\n            value = checkboxes\n              .filter((checkbox) => checkbox.checked)\n              .map((checkbox) => checkbox.value);\n          } else {\n            value = checkboxes[0].checked;\n          }\n        } else {\n          let checkValues = get(stateRef.current.values, field.name);\n\n          if (Array.isArray(checkValues)) {\n            checkValues = new Set(checkValues);\n\n            if (field.checked) {\n              checkValues.add(value);\n            } else {\n              checkValues.delete(value);\n            }\n\n            value = Array.from(checkValues);\n          } else {\n            value = field.checked;\n          }\n        }\n      }\n\n      if (isRadioInput(field) && options)\n        value =\n          (options as HTMLInputElement[]).find((radio) => radio.checked)\n            ?.value || \"\";\n\n      if (isMultipleSelect(field) && !options)\n        value = Array.from(field.options)\n          .filter((option) => option.selected)\n          .map((option) => option.value);\n\n      if (isFileInput(field)) value = field.files;\n\n      return value;\n    },\n    [stateRef]\n  );\n\n  const setNodeValue = useCallback((name: string, value: any) => {\n    if (!fieldsRef.current[name] || controllersRef.current[name]) return;\n\n    const { field, options } = fieldsRef.current[name];\n\n    if (isCheckboxInput(field)) {\n      const checkboxes = options as HTMLInputElement[];\n\n      if (checkboxes.length > 1) {\n        checkboxes.forEach((checkbox) => {\n          checkbox.checked = Array.isArray(value)\n            ? value.includes(checkbox.value)\n            : !!value;\n        });\n      } else {\n        checkboxes[0].checked = !!value;\n      }\n    } else if (isRadioInput(field)) {\n      (options as HTMLInputElement[]).forEach((radio) => {\n        radio.checked = radio.value === value;\n      });\n    } else if (isMultipleSelect(field) && Array.isArray(value)) {\n      Array.from(field.options).forEach((option) => {\n        option.selected = !!value.includes(option.value);\n      });\n    } else if (isFileInput(field)) {\n      if (isFileList(value)) field.files = value;\n      if (!value) field.value = \"\";\n    } else {\n      field.value = value ?? \"\";\n    }\n  }, []);\n\n  const setDefaultValue = useCallback(\n    (name: string, value: any) => {\n      if (!isUndefined(get(initialStateRef.current.values, name))) return;\n\n      initialStateRef.current.values = set(\n        initialStateRef.current.values,\n        name,\n        value,\n        true\n      );\n\n      setStateRef(`values.${name}`, get(initialStateRef.current.values, name), {\n        shouldUpdate: !isInitRef.current,\n      });\n    },\n    [setStateRef]\n  );\n\n  const setNodesOrStateValue = useCallback(\n    (\n      values: V,\n      checkDefaultValues = false,\n      fields: FieldsValue[] | string[] = Object.values(fieldsRef.current)\n    ) =>\n      fields.forEach((field: FieldsValue | string) => {\n        const name = isPlainObject(field)\n          ? (field as FieldsValue).field.name\n          : field;\n\n        if (controllersRef.current[name]) return;\n\n        const value = get(values, name);\n\n        if (!isUndefined(value)) setNodeValue(name, value);\n\n        if (checkDefaultValues) {\n          const defaultValue = get(defaultValuesRef.current, name);\n\n          setDefaultValue(\n            name,\n            !isUndefined(defaultValue) ? defaultValue : getNodeValue(name)\n          );\n        }\n      }),\n    [getNodeValue, setDefaultValue, setNodeValue]\n  );\n\n  const getState = useCallback<GetState>(\n    (path, { target, watch = true, errorWithTouched = false } = {}) => {\n      if (!path) return undefined;\n\n      const getPath = (p: string) => {\n        if (p === \"values\" && !target && watch)\n          warn(\n            '💡 react-cool-form > getState: Get the \"values\" alone may cause unnecessary re-renders. If you know what you\\'re doing, please ignore this warning. See: https://react-cool-form.netlify.app/docs/getting-started/form-state#best-practices'\n          );\n\n        p = target ? `${target}.${p}` : p;\n\n        if (watch) setUsedStateRef(p);\n\n        return p;\n      };\n      const errorsEnhancer = (p: string, state: any) => {\n        if (\n          !watch ||\n          !errorWithTouched ||\n          !p.startsWith(\"errors\") ||\n          !state ||\n          isEmptyObject(state)\n        )\n          return state;\n\n        p = p.replace(\"errors\", \"touched\");\n        setUsedStateRef(p);\n\n        return filterErrors(state, get(stateRef.current, p));\n      };\n      let state;\n\n      if (Array.isArray(path)) {\n        state = path.map((p) => {\n          p = getPath(p);\n          return errorsEnhancer(p, get(stateRef.current, p));\n        });\n      } else if (isPlainObject(path)) {\n        const paths = path as Record<string, string>;\n        state = Object.keys(paths).reduce((s: Record<string, any>, key) => {\n          path = getPath(paths[key]);\n          s[key] = errorsEnhancer(path, get(stateRef.current, path));\n          return s;\n        }, {});\n      } else {\n        path = getPath(path);\n        state = errorsEnhancer(path, get(stateRef.current, path));\n      }\n\n      return state;\n    },\n    [setUsedStateRef, stateRef]\n  );\n\n  const setError = useCallback<SetError>(\n    (name, error) => {\n      error = isFunction(error)\n        ? error(get(stateRef.current.errors, name))\n        : error;\n\n      if (error) {\n        setStateRef(`errors.${name}`, error);\n      } else {\n        handleUnset(\"errors\", `errors.${name}`, stateRef.current.errors, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const clearErrors = useCallback<ClearErrors>(\n    (name) => {\n      if (!name) {\n        setStateRef(\"errors\", {});\n      } else if (Array.isArray(name)) {\n        name.forEach((n) =>\n          handleUnset(\"errors\", `errors.${n}`, stateRef.current.errors, n)\n        );\n      } else {\n        handleUnset(\"errors\", `errors.${name}`, stateRef.current.errors, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const runBuiltInValidation = useCallback(\n    (name: string) => {\n      if (builtInValidationMode === false || !fieldsRef.current[name])\n        return undefined;\n\n      const { field } = fieldsRef.current[name];\n\n      if (builtInValidationMode === \"message\") return field.validationMessage;\n\n      for (const k in field.validity) {\n        // @ts-expect-error\n        if (k !== \"valid\" && field.validity[k]) return k;\n      }\n\n      return undefined;\n    },\n    [builtInValidationMode]\n  );\n\n  const runAllBuiltInValidation = useCallback(() => {\n    if (builtInValidationMode === false) return {};\n\n    return Object.keys(fieldsRef.current).reduce((errors, name) => {\n      const error = runBuiltInValidation(name);\n      errors = { ...errors, ...(error ? set({}, name, error) : {}) };\n      return errors;\n    }, {});\n  }, [builtInValidationMode, runBuiltInValidation]);\n\n  const runFieldValidation = useCallback(\n    async (name: string): Promise<any> => {\n      if (!fieldValidatorsRef.current[name]) return undefined;\n\n      try {\n        const error = await fieldValidatorsRef.current[name](\n          get(stateRef.current.values, name),\n          stateRef.current.values\n        );\n\n        return error;\n      } catch (exception) {\n        warn(`💡 react-cool-form > validate ${name}: `, exception);\n        throw exception;\n      }\n    },\n    [stateRef]\n  );\n\n  const runAllFieldsValidation = useCallback((): Promise<FormErrors<V>> => {\n    const promises = Object.keys(fieldValidatorsRef.current).map((name) =>\n      runFieldValidation(name)\n    );\n\n    return Promise.all(promises).then((errors) =>\n      Object.keys(fieldValidatorsRef.current).reduce((acc, cur, idx) => {\n        acc = { ...acc, ...(errors[idx] ? set({}, cur, errors[idx]) : {}) };\n        return acc;\n      }, {})\n    );\n  }, [runFieldValidation]);\n\n  const runFormValidation = useCallback(\n    async (name?: string): Promise<any> => {\n      if (!formValidatorRef.current) return name ? undefined : {};\n\n      try {\n        const errors = await formValidatorRef.current(stateRef.current.values);\n\n        if (name) return get(errors, name);\n\n        return isPlainObject(errors) ? errors : {};\n      } catch (exception) {\n        warn(`💡 react-cool-form > validate form: `, exception);\n        throw exception;\n      }\n    },\n    [formValidatorRef, stateRef]\n  );\n\n  const validateField = useCallback(\n    async (name: string) => {\n      const hasAsyncValidator =\n        isAsyncFunction(formValidatorRef.current) ||\n        isAsyncFunction(fieldValidatorsRef.current[name]);\n\n      if (hasAsyncValidator) setStateRef(\"isValidating\", true);\n\n      try {\n        const error =\n          (await runFormValidation(name)) ||\n          (await runFieldValidation(name)) ||\n          runBuiltInValidation(name);\n\n        setError(name, error);\n        if (hasAsyncValidator) setStateRef(\"isValidating\", false);\n\n        return error;\n      } catch (exception) {\n        return exception;\n      }\n    },\n    [\n      formValidatorRef,\n      runBuiltInValidation,\n      runFieldValidation,\n      runFormValidation,\n      setError,\n      setStateRef,\n    ]\n  );\n\n  const validateFieldWithLowPriority = useCallback<typeof validateField>(\n    (name) => runWithLowPriority(() => validateField(name)),\n    [validateField]\n  );\n\n  const validateForm = useCallback((): Promise<FormErrors<V>> => {\n    setStateRef(\"isValidating\", true);\n\n    return Promise.all([\n      runAllBuiltInValidation(),\n      runAllFieldsValidation(),\n      runFormValidation(),\n    ]).then((errors) => {\n      const errs = deepMerge(...errors);\n\n      setStateRef(\"errors\", errs);\n      setStateRef(\"isValidating\", false);\n\n      return errs;\n    });\n  }, [\n    runAllBuiltInValidation,\n    runAllFieldsValidation,\n    runFormValidation,\n    setStateRef,\n  ]);\n\n  const runValidation = useCallback<RunValidation>(\n    (name) => {\n      if (!name) return validateForm().then((errors) => isEmptyObject(errors));\n\n      if (Array.isArray(name))\n        return Promise.all(name.map((n) => validateField(n))).then(\n          (errors) => !compact(errors).length\n        );\n\n      return validateField(name).then((error) => !error);\n    },\n    [validateField, validateForm]\n  );\n\n  const setTouched = useCallback<SetTouched>(\n    (name, isTouched = true, shouldValidate = validateOnBlur) => {\n      if (isTouched) {\n        setStateRef(`touched.${name}`, true);\n      } else {\n        handleUnset(\n          \"touched\",\n          `touched.${name}`,\n          stateRef.current.touched,\n          name\n        );\n      }\n\n      if (shouldValidate) validateFieldWithLowPriority(name);\n    },\n    [\n      handleUnset,\n      setStateRef,\n      stateRef,\n      validateFieldWithLowPriority,\n      validateOnBlur,\n    ]\n  );\n\n  const setTouchedMaybeValidate = useCallback(\n    (name: string) =>\n      setTouched(\n        name,\n        true,\n        validateOnChange ? name !== changedFieldRef.current : undefined\n      ),\n    [setTouched, validateOnChange]\n  );\n\n  const setDirty = useCallback<SetDirty>(\n    (name, isDirty = true) => {\n      if (isDirty) {\n        setStateRef(`dirty.${name}`, true);\n      } else {\n        handleUnset(\"dirty\", `dirty.${name}`, stateRef.current.dirty, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const setDirtyIfNeeded = useCallback(\n    (name: string) =>\n      setDirty(\n        name,\n        get(stateRef.current.values, name) !==\n          get(initialStateRef.current.values, name)\n      ),\n    [setDirty, stateRef]\n  );\n\n  const setValue = useCallback<SetValue>(\n    (\n      name,\n      value,\n      {\n        shouldValidate = validateOnChange,\n        shouldTouched = true,\n        shouldDirty = true,\n      } = {}\n    ) => {\n      value = isFunction(value)\n        ? value(get(stateRef.current.values, name))\n        : value;\n\n      if (!isUndefined(value)) {\n        setStateRef(`values.${name}`, value);\n      } else {\n        handleUnset(\"values\", `values.${name}`, stateRef.current.values, name);\n      }\n      setNodeValue(name, value);\n\n      if (shouldTouched) setTouched(name, true, false);\n      if (shouldDirty) setDirtyIfNeeded(name);\n      if (shouldValidate) validateFieldWithLowPriority(name);\n    },\n    [\n      handleUnset,\n      setDirtyIfNeeded,\n      setNodeValue,\n      setStateRef,\n      setTouched,\n      stateRef,\n      validateFieldWithLowPriority,\n      validateOnChange,\n    ]\n  );\n\n  const getOptions = useCallback(\n    () => ({\n      formState: stateRef.current,\n      setValue,\n      setTouched,\n      setDirty,\n      setError,\n      clearErrors,\n      runValidation,\n      reset,\n      submit,\n    }),\n    [\n      clearErrors,\n      // @ts-expect-error\n      reset,\n      runValidation,\n      setDirty,\n      setError,\n      setTouched,\n      setValue,\n      stateRef,\n      // @ts-expect-error\n      submit,\n    ]\n  );\n\n  const reset: Reset<V> = useCallback(\n    (values, exclude, e) => {\n      e?.preventDefault();\n      e?.stopPropagation();\n\n      const state = { ...stateRef.current };\n      const skip = arrayToMap(exclude || []);\n\n      Object.keys(state).forEach((key) => {\n        if (skip[key]) return;\n\n        if (key === \"values\") {\n          const nextValues =\n            (isFunction(values) ? values(stateRef.current.values) : values) ||\n            initialStateRef.current.values;\n\n          state[key] = nextValues;\n          initialStateRef.current.values = nextValues;\n          setNodesOrStateValue(initialStateRef.current.values, !!values);\n        } else {\n          // @ts-expect-error\n          state[key] = initialStateRef.current[key];\n        }\n      });\n\n      setStateRef(\"\", state);\n      onResetRef.current(state.values, getOptions(), e);\n    },\n    [getOptions, onResetRef, setNodesOrStateValue, setStateRef, stateRef]\n  );\n\n  const submit: Submit<V> = useCallback(\n    async (e) => {\n      e?.preventDefault();\n      e?.stopPropagation();\n\n      const nextTouched = Object.keys({\n        ...fieldsRef.current,\n        ...controllersRef.current,\n      }).reduce((touched, name) => {\n        touched = set(touched, name, true, true);\n        return touched;\n      }, stateRef.current.touched);\n\n      setStateRef(\"touched\", nextTouched);\n      setStateRef(\"isSubmitting\", true);\n\n      try {\n        const errors = await validateForm();\n\n        if (!isEmptyObject(errors)) {\n          onErrorRef.current(errors, getOptions(), e);\n\n          return { errors };\n        }\n\n        await onSubmitRef.current(stateRef.current.values, getOptions(), e);\n        setStateRef(\"isSubmitted\", true);\n\n        return { values: stateRef.current.values };\n      } catch (exception) {\n        warn(`💡 react-cool-form > submit: `, exception);\n        throw exception;\n      } finally {\n        setStateRef(\"isSubmitting\", false);\n      }\n    },\n    [getOptions, onErrorRef, onSubmitRef, setStateRef, stateRef, validateForm]\n  );\n\n  const handleChangeEvent = useCallback(\n    (name: string, value: any) => {\n      setStateRef(`values.${name}`, value);\n      setDirtyIfNeeded(name);\n\n      if (validateOnChange) validateFieldWithLowPriority(name);\n    },\n    [\n      setDirtyIfNeeded,\n      setStateRef,\n      validateFieldWithLowPriority,\n      validateOnChange,\n    ]\n  );\n\n  const controller = useCallback<Controller<V>>(\n    (\n      name,\n      {\n        validate: validator,\n        value,\n        defaultValue,\n        parse,\n        format,\n        onChange,\n        onBlur,\n      } = {}\n    ) => {\n      if (!name) {\n        warn('💡 react-cool-form > controller: Missing the \"name\" parameter.');\n        return undefined;\n      }\n\n      controllersRef.current[name] = true;\n      if (validator) fieldValidatorsRef.current[name] = validator;\n\n      const val = get(defaultValuesRef.current, name);\n      defaultValue = !isUndefined(val) ? val : defaultValue;\n      if (!isUndefined(defaultValue)) setDefaultValue(name, defaultValue);\n\n      value = !isUndefined(value) ? value : getState(`values.${name}`);\n      value = (format ? format(value) : value) ?? \"\";\n\n      return {\n        name,\n        value,\n        onChange: (...args) => {\n          let v;\n\n          if (parse) {\n            v = parse(...args);\n          } else {\n            const e = args[0];\n            v =\n              e?.nativeEvent instanceof Event && isFieldElement(e.target)\n                ? getNodeValue(name)\n                : e;\n          }\n\n          handleChangeEvent(name, v);\n          if (onChange) onChange(...args, v);\n          changedFieldRef.current = name;\n        },\n        onBlur: (e) => {\n          setTouchedMaybeValidate(name);\n          if (onBlur) onBlur(e);\n          changedFieldRef.current = undefined;\n        },\n      };\n    },\n    [\n      getNodeValue,\n      getState,\n      handleChangeEvent,\n      setDefaultValue,\n      setTouchedMaybeValidate,\n    ]\n  );\n\n  useIsoLayoutEffect(() => {\n    if (!formRef.current) return;\n\n    fieldsRef.current = getFields(formRef.current);\n    setNodesOrStateValue(initialStateRef.current.values, true);\n    isInitRef.current = false;\n  }, [getFields, setNodesOrStateValue]);\n\n  useEffect(() => {\n    if (!formRef.current) return () => null;\n\n    const handleChange = ({ target }: Event) => {\n      const { name } = target as FieldElement;\n\n      if (!name) {\n        warn('💡 react-cool-form > field: Missing the \"name\" attribute.');\n        return;\n      }\n\n      if (fieldsRef.current[name] && !controllersRef.current[name]) {\n        const parse = fieldArgsRef.current[name]?.parse;\n        const value = getNodeValue(name);\n\n        handleChangeEvent(name, parse ? parse(value) : value);\n        changedFieldRef.current = name;\n      }\n    };\n\n    const handleBlur = ({ target }: Event) => {\n      if (!isFieldElement(target as HTMLElement)) return;\n\n      const { name } = target as FieldElement;\n\n      if (fieldsRef.current[name] && !controllersRef.current[name]) {\n        setTouchedMaybeValidate(name);\n        changedFieldRef.current = undefined;\n      }\n    };\n\n    const handleSubmit = (e: Event) => submit(e as any);\n\n    const handleReset = (e: Event) => reset(null, null, e as any);\n\n    const form = formRef.current;\n    form.addEventListener(\"input\", handleChange);\n    form.addEventListener(\"focusout\", handleBlur);\n    form.addEventListener(\"submit\", handleSubmit);\n    form.addEventListener(\"reset\", handleReset);\n\n    const observer = new MutationObserver(([{ type }]) => {\n      if (type !== \"childList\") return;\n\n      const fields = getFields(form);\n      let { values } = stateRef.current;\n\n      if (shouldRemoveField)\n        Object.keys(fieldsRef.current).forEach((name) => {\n          if (fields[name]) return;\n\n          handleUnset(\n            \"values\",\n            `values.${name}`,\n            stateRef.current.values,\n            name\n          );\n          handleUnset(\n            \"touched\",\n            `touched.${name}`,\n            stateRef.current.touched,\n            name\n          );\n          handleUnset(\"dirty\", `dirty.${name}`, stateRef.current.dirty, name);\n          handleUnset(\n            \"errors\",\n            `errors.${name}`,\n            stateRef.current.errors,\n            name\n          );\n          setUsedStateRef(name, true);\n\n          initialStateRef.current.values = unset(\n            initialStateRef.current.values,\n            name,\n            true\n          );\n          delete fieldArgsRef.current[name];\n          delete fieldValidatorsRef.current[name];\n          delete controllersRef.current[name];\n        });\n\n      const addedNodes: string[] = [];\n\n      Object.keys(fields).forEach((name) => {\n        if (fieldsRef.current[name] || controllersRef.current[name]) return;\n\n        const defaultValue = get(defaultValuesRef.current, name);\n\n        if (!isUndefined(defaultValue))\n          values = set(values, name, defaultValue, true);\n\n        addedNodes.push(name);\n      });\n\n      fieldsRef.current = fields;\n      if (addedNodes.length) setNodesOrStateValue(values, true, addedNodes);\n    });\n    observer.observe(form, { childList: true, subtree: true });\n\n    return () => {\n      form.removeEventListener(\"input\", handleChange);\n      form.removeEventListener(\"focusout\", handleBlur);\n      form.removeEventListener(\"submit\", handleSubmit);\n      form.removeEventListener(\"reset\", handleReset);\n      observer.disconnect();\n    };\n  }, [\n    getFields,\n    getNodeValue,\n    handleChangeEvent,\n    handleUnset,\n    reset,\n    setNodesOrStateValue,\n    setTouchedMaybeValidate,\n    setUsedStateRef,\n    shouldRemoveField,\n    stateRef,\n    submit,\n  ]);\n\n  return {\n    form: formRef,\n    field: fieldRef,\n    getState,\n    setValue,\n    setTouched,\n    setDirty,\n    setError,\n    clearErrors,\n    runValidation,\n    reset,\n    submit,\n    controller,\n  };\n};\n"],"names":["val","ref","useRef","useEffect","current","arr","reduce","obj","key","value","FileList","cloneObject","object","Event","Error","isObject","isFileList","Date","getTime","Array","isArray","map","Object","keys","filter","Boolean","deepMerge","objects","prev","forEach","prevValue","currValue","isPlainObject","undefined","filterErrors","error","touched","nextErrors","isUndefined","str","TypeError","length","compact","split","path","defaultValue","stringToPath","getIsDirty","dirty","search","dty","found","values","push","isFunction","constructor","name","field","type","element","test","tagName","callback","window","requestIdleCallback","cb","start","now","setTimeout","didTimeout","timeRemaining","Math","max","timeout","immutable","segs","newObject","slice","idx","nextIsNumber","Number","isNaN","refObject","hasOwnProperty","last","pop","target","__DEV__","console","warn","initialState","onChange","useReducer","c","forceUpdate","stateRef","usedStateRef","onChangeRef","useLatest","setStateRef","useCallback","fieldPath","shouldUpdate","dequal","get","state","set","errors","prevIsDirty","isDirty","prevIsValid","isValid","prevSubmitCount","submitCount","isEmptyObject","some","k","startsWith","setUsedStateRef","unset","useIsoLayoutEffect","useLayoutEffect","defaultValues","validate","validateOnChange","validateOnBlur","builtInValidationMode","shouldRemoveField","excludeFields","onReset","onSubmit","onError","debug","isInitRef","formRef","fieldsRef","fieldArgsRef","controllersRef","excludeFieldsRef","arrayToMap","changedFieldRef","formValidatorRef","fieldValidatorsRef","onResetRef","onSubmitRef","onErrorRef","defaultValuesRef","initialStateRef","isValidating","isSubmitting","isSubmitted","useState","getFields","form","from","querySelectorAll","rcfExclude","dataset","acc","cur","isCheckboxInput","isRadioInput","options","handleUnset","fieldRef","validateOrOptions","validator","parsers","getNodeValue","isInputElement","valueAsNumber","valueAsDate","isNumberInput","isRangeInput","checkboxes","checkbox","checked","checkValues","Set","add","find","radio","isMultipleSelect","option","selected","isFileInput","files","setNodeValue","includes","setDefaultValue","setNodesOrStateValue","checkDefaultValues","fields","getState","watch","errorWithTouched","getPath","p","errorsEnhancer","replace","paths","s","setError","clearErrors","n","runBuiltInValidation","validationMessage","validity","runAllBuiltInValidation","runFieldValidation","exception","runAllFieldsValidation","promises","Promise","all","then","runFormValidation","validateField","hasAsyncValidator","isAsyncFunction","validateFieldWithLowPriority","runWithLowPriority","validateForm","errs","runValidation","setTouched","isTouched","shouldValidate","setTouchedMaybeValidate","setDirty","setDirtyIfNeeded","setValue","shouldTouched","shouldDirty","getOptions","formState","reset","submit","exclude","e","preventDefault","stopPropagation","skip","nextValues","nextTouched","handleChangeEvent","controller","parse","format","onBlur","v","args","nativeEvent","isFieldElement","handleChange","handleBlur","handleSubmit","handleReset","addEventListener","observer","MutationObserver","addedNodes","observe","childList","subtree","removeEventListener","disconnect"],"mappings":"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"}