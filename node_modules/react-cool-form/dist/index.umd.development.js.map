{"version":3,"file":"index.umd.development.js","sources":["../node_modules/dequal/lite/index.mjs","../src/hooks/useLatest.ts","../src/utils/arrayToMap.ts","../src/utils/isObject.ts","../src/utils/isFileList.ts","../src/utils/cloneObject.ts","../src/utils/compact.ts","../src/utils/isPlainObject.ts","../src/utils/deepMerge.ts","../src/utils/isUndefined.ts","../src/utils/filterErrors.ts","../src/utils/stringToPath.ts","../src/utils/get.ts","../src/utils/getIsDirty.ts","../src/utils/isFunction.ts","../src/utils/isAsyncFunction.ts","../src/utils/isCheckboxInput.ts","../src/utils/isEmptyObject.ts","../src/utils/isFieldElement.ts","../src/utils/isFileInput.ts","../src/utils/isInputElement.ts","../src/utils/isMultipleSelect.ts","../src/utils/isNumberInput.ts","../src/utils/isRadioInput.ts","../src/utils/isRangeInput.ts","../src/utils/runWithLowPriority.ts","../src/utils/set.ts","../src/utils/unset.ts","../src/utils/warn.ts","../src/hooks/useState.ts","../src/hooks/useIsoLayoutEffect.ts","../src/useForm.ts"],"sourcesContent":["var has = Object.prototype.hasOwnProperty;\n\nexport function dequal(foo, bar) {\n\tvar ctor, len;\n\tif (foo === bar) return true;\n\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\n\t\tif (ctor === Array) {\n\t\t\tif ((len=foo.length) === bar.length) {\n\t\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (!ctor || typeof foo === 'object') {\n\t\t\tlen = 0;\n\t\t\tfor (ctor in foo) {\n\t\t\t\tif (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n\t\t\t\tif (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n\t\t\t}\n\t\t\treturn Object.keys(bar).length === len;\n\t\t}\n\t}\n\n\treturn foo !== foo && bar !== bar;\n}\n","import { MutableRefObject, useRef, useEffect } from \"react\";\n\nexport default <T>(val: T): MutableRefObject<T> => {\n  const ref = useRef(val);\n\n  useEffect(() => {\n    ref.current = val;\n  });\n\n  return ref;\n};\n","import { Map } from \"../types\";\n\nexport default (arr: any[]): Map =>\n  arr.reduce((obj, key) => {\n    obj[key] = true;\n    return obj;\n  }, {});\n","export default (value: unknown): value is Object =>\n  value !== null && typeof value === \"object\";\n","export default (value: unknown): value is FileList => value instanceof FileList;\n","import isObject from \"./isObject\";\nimport isFileList from \"./isFileList\";\n\nconst cloneObject = (object: unknown): any => {\n  if (object instanceof Event) throw new Error(\"Unable to clone event.\");\n\n  if (!isObject(object) || isFileList(object)) return object;\n\n  if (object instanceof Date) return new Date(object.getTime());\n\n  if (Array.isArray(object)) return object.map((val) => cloneObject(val));\n\n  if (isObject(object))\n    return Object.keys(object).reduce((obj: Record<string, any>, key) => {\n      obj[key] = cloneObject((object as Record<string, any>)[key]);\n      return obj;\n    }, {});\n\n  throw new Error(\"Unable to clone object.\");\n};\n\nexport default cloneObject;\n","export default (arr: any[]): any[] => arr.filter(Boolean);\n","import isObject from \"./isObject\";\n\nexport default (value: unknown): value is Object =>\n  !Array.isArray(value) && !(value instanceof Date) && isObject(value);\n","import isPlainObject from \"./isPlainObject\";\n\nconst deepMerge = (...objects: any[]): any =>\n  objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const prevValue = prev[key];\n      const currValue = obj[key];\n\n      if (Array.isArray(prevValue) && Array.isArray(currValue)) {\n        prev[key] = [...prevValue, ...currValue];\n      } else if (isPlainObject(prevValue) && isPlainObject(currValue)) {\n        prev[key] = deepMerge(prevValue, currValue);\n      } else {\n        prev[key] = currValue;\n      }\n    });\n\n    return prev;\n  }, {});\n\nexport default deepMerge;\n","export default (value: unknown): value is undefined => value === undefined;\n","import isPlainObject from \"./isPlainObject\";\nimport isUndefined from \"./isUndefined\";\n\nconst filterErrors = (error: unknown, touched: unknown): any => {\n  if (!isPlainObject(error)) return touched ? error : undefined;\n\n  return Object.keys(error).reduce((obj: Record<string, any>, key) => {\n    const nextErrors = filterErrors(\n      (error as Record<string, any>)[key],\n      (touched as Record<string, any>)[key] || false\n    );\n\n    if (!isUndefined(nextErrors)) {\n      obj[key] = nextErrors;\n    } else {\n      delete obj[key];\n    }\n\n    return obj;\n  }, {});\n};\n\nexport default filterErrors;\n","import compact from \"./compact\";\n\nexport default (str: string): string[] => {\n  if (typeof str !== \"string\") throw new TypeError(\"Expected a string.\");\n  if (!str.length) return [];\n\n  return compact(str.split(/[.[\\]]+/));\n};\n","import isPlainObject from \"./isPlainObject\";\nimport isUndefined from \"./isUndefined\";\nimport stringToPath from \"./stringToPath\";\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport default (object: any, path: string, defaultValue?: unknown): any => {\n  if (!isPlainObject(object) || !path) return defaultValue;\n\n  const value = stringToPath(path).reduce(\n    (obj, key) => (obj || {})[key],\n    object\n  );\n\n  return isUndefined(value) ? defaultValue : value;\n};\n","import isPlainObject from \"./isPlainObject\";\n\nconst getIsDirty = (dirty: object): boolean => {\n  const search = (dty: object, found: any[] = []) => {\n    for (const val of Object.values(dty)) {\n      if (val === true) {\n        found.push(val);\n        return found;\n      }\n\n      if (isPlainObject(val)) search(val, found);\n    }\n\n    return found;\n  };\n\n  return !!search(dirty).length;\n};\n\nexport default getIsDirty;\n","export default (value: unknown): value is Function =>\n  typeof value === \"function\";\n","import isFunction from \"./isFunction\";\n\nexport default (value: unknown): value is Promise<any> =>\n  isFunction(value) && value.constructor.name === \"AsyncFunction\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"checkbox\";\n","import isPlainObject from \"./isPlainObject\";\n\nexport default (value: unknown): value is Record<string, never> =>\n  isPlainObject(value) && !Object.keys(value).length;\n","import { FieldElement } from \"../types\";\n\nexport default (element: HTMLElement): element is FieldElement =>\n  /INPUT|TEXTAREA|SELECT/.test(element.tagName);\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"file\";\n","export default (element: HTMLElement): element is HTMLInputElement =>\n  element.tagName === \"INPUT\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLSelectElement =>\n  field.type === \"select-multiple\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"number\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"radio\";\n","import { FieldElement } from \"../types\";\n\nexport default (field: FieldElement): field is HTMLInputElement =>\n  field.type === \"range\";\n","export default (callback: (args: any) => any): any =>\n  (\n    window.requestIdleCallback ||\n    ((cb) => {\n      const start = Date.now();\n      return setTimeout(\n        () =>\n          cb({\n            didTimeout: false,\n            timeRemaining: () => Math.max(0, 50 - (Date.now() - start)),\n          }),\n        1\n      );\n    })\n  )(callback, { timeout: 2000 });\n","import cloneObject from \"./cloneObject\";\nimport isPlainObject from \"./isPlainObject\";\nimport stringToPath from \"./stringToPath\";\n\nexport default (\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  object: any,\n  path: string,\n  value: unknown,\n  immutable = false\n): any => {\n  if (!isPlainObject(object)) throw new TypeError(\"Expected an object.\");\n\n  const segs = stringToPath(path);\n  const newObject = immutable ? cloneObject(object) : object;\n\n  segs.slice(0, -1).reduce((obj, key, idx) => {\n    const nextIsNumber = !Number.isNaN(Number(segs[idx + 1]));\n    if (isPlainObject(obj[key]) && !nextIsNumber) return obj[key];\n    obj[key] = nextIsNumber ? [] : {};\n    return obj[key];\n  }, newObject)[segs[segs.length - 1] || \"\"] = value;\n\n  return newObject;\n};\n","/* eslint-disable no-prototype-builtins */\n\nimport cloneObject from \"./cloneObject\";\nimport isPlainObject from \"./isPlainObject\";\nimport isObject from \"./isObject\";\nimport stringToPath from \"./stringToPath\";\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport default (object: any, path: string, immutable = false): any => {\n  if (!isPlainObject(object)) throw new TypeError(\"Expected an object.\");\n\n  const refObject = immutable ? cloneObject(object) : object;\n  const newObject = refObject;\n\n  if (newObject.hasOwnProperty(path)) {\n    delete newObject[path];\n    return refObject;\n  }\n\n  const segs = stringToPath(path);\n\n  if (!segs.length) return refObject;\n\n  const last = segs.pop() as string;\n  const target = segs.reduce((obj, key) => (obj || {})[key], newObject);\n\n  if (isObject(target) && target.hasOwnProperty(last)) delete target[last];\n\n  return refObject;\n};\n","export default (...args: any[]): void => {\n  if (__DEV__) console.warn(...args);\n};\n","import { useReducer, useRef, useCallback } from \"react\";\nimport { dequal } from \"dequal/lite\";\n\nimport {\n  Debug,\n  FormState,\n  FormStateReturn,\n  Map,\n  SetStateRef,\n  SetUsedStateRef,\n} from \"../types\";\nimport useLatest from \"./useLatest\";\nimport { get, getIsDirty, isEmptyObject, set } from \"../utils\";\n\nexport default <V>(\n  initialState: FormState<V>,\n  onChange?: Debug<V>\n): FormStateReturn<V> => {\n  const [, forceUpdate] = useReducer((c) => c + 1, 0);\n  const stateRef = useRef(initialState);\n  const usedStateRef = useRef<Map>({});\n  const onChangeRef = useLatest(onChange || (() => undefined));\n\n  const setStateRef = useCallback<SetStateRef>(\n    (path, value, { fieldPath, shouldUpdate = true } = {}) => {\n      const key = path.split(\".\")[0];\n\n      if (!key) {\n        if (!dequal(stateRef.current, value)) {\n          stateRef.current = value;\n          forceUpdate();\n          onChangeRef.current(stateRef.current);\n        }\n\n        return;\n      }\n\n      if (\n        (path !== \"values\" && key === \"values\") ||\n        !dequal(get(stateRef.current, path), value)\n      ) {\n        const state = set(stateRef.current, path, value, true);\n        const {\n          errors,\n          dirty,\n          isDirty: prevIsDirty,\n          isValid: prevIsValid,\n        } = state;\n        let { submitCount: prevSubmitCount } = state;\n        const isDirty = key === \"dirty\" ? getIsDirty(dirty) : prevIsDirty;\n        const isValid = key === \"errors\" ? isEmptyObject(errors) : prevIsValid;\n        const submitCount =\n          key === \"isSubmitting\" && value\n            ? (prevSubmitCount += 1)\n            : prevSubmitCount;\n\n        stateRef.current = { ...state, isDirty, isValid, submitCount };\n\n        path = fieldPath || path;\n\n        if (\n          shouldUpdate &&\n          (Object.keys(usedStateRef.current).some(\n            (k) => path.startsWith(k) || k.startsWith(path)\n          ) ||\n            (usedStateRef.current.isDirty && isDirty !== prevIsDirty) ||\n            (usedStateRef.current.isValid && isValid !== prevIsValid))\n        ) {\n          forceUpdate();\n          onChangeRef.current(stateRef.current);\n        }\n      }\n    },\n    [onChangeRef]\n  );\n\n  const setUsedStateRef = useCallback<SetUsedStateRef>(\n    (path, unset = false) => {\n      if (unset) {\n        delete usedStateRef.current[path];\n      } else {\n        usedStateRef.current[path] = true;\n      }\n    },\n    []\n  );\n\n  return { stateRef, setStateRef, setUsedStateRef };\n};\n","import { useEffect, useLayoutEffect } from \"react\";\n\nconst useIsoLayoutEffect =\n  typeof window === \"undefined\" ? useEffect : useLayoutEffect;\n\nexport default useIsoLayoutEffect;\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport { useCallback, useEffect, useRef } from \"react\";\n\nimport {\n  ClearErrors,\n  Config,\n  Controller,\n  FieldArgs,\n  FieldElement,\n  FieldRef,\n  Fields,\n  FieldValidator,\n  FieldsValue,\n  FormErrors,\n  FormState,\n  FormValues,\n  GetState,\n  Map,\n  Reset,\n  Return,\n  RunValidation,\n  SetDirty,\n  SetError,\n  SetTouched,\n  SetValue,\n  Submit,\n} from \"./types\";\nimport { useIsoLayoutEffect, useLatest, useState } from \"./hooks\";\nimport {\n  arrayToMap,\n  compact,\n  deepMerge,\n  filterErrors,\n  get,\n  isAsyncFunction,\n  isCheckboxInput,\n  isEmptyObject,\n  isFieldElement,\n  isFileInput,\n  isFileList,\n  isFunction,\n  isInputElement,\n  isMultipleSelect,\n  isNumberInput,\n  isPlainObject,\n  isRadioInput,\n  isRangeInput,\n  isUndefined,\n  runWithLowPriority,\n  set,\n  unset,\n  warn,\n} from \"./utils\";\n\nexport default <V extends FormValues = FormValues>({\n  defaultValues = {} as V,\n  validate,\n  validateOnChange = true,\n  validateOnBlur = true,\n  builtInValidationMode = \"message\",\n  shouldRemoveField = true,\n  excludeFields = [],\n  onReset,\n  onSubmit,\n  onError,\n  debug,\n}: Config<V> = {}): Return<V> => {\n  const isInitRef = useRef(true);\n  const formRef = useRef<HTMLFormElement>(null);\n  const fieldsRef = useRef<Fields>({});\n  const fieldArgsRef = useRef<FieldArgs>({});\n  const controllersRef = useRef<Map>({});\n  const excludeFieldsRef = useRef<Map>(arrayToMap(excludeFields));\n  const changedFieldRef = useRef<string>();\n  const formValidatorRef = useLatest(validate);\n  const fieldValidatorsRef = useRef<Record<string, FieldValidator<V>>>({});\n  const onResetRef = useLatest(onReset || (() => undefined));\n  const onSubmitRef = useLatest(onSubmit || (() => undefined));\n  const onErrorRef = useLatest(onError || (() => undefined));\n  const defaultValuesRef = useRef(defaultValues);\n  const initialStateRef = useRef<FormState<V>>({\n    values: defaultValuesRef.current,\n    touched: {},\n    errors: {},\n    isDirty: false,\n    dirty: {},\n    isValidating: false,\n    isValid: true,\n    isSubmitting: false,\n    isSubmitted: false,\n    submitCount: 0,\n  });\n  const { stateRef, setStateRef, setUsedStateRef } = useState<V>(\n    initialStateRef.current,\n    debug\n  );\n\n  const getFields = useCallback(\n    (form: HTMLFormElement) =>\n      Array.from(form.querySelectorAll(\"input,textarea,select\"))\n        .filter((element) => {\n          const field = element as FieldElement;\n          const {\n            type,\n            name,\n            dataset: { rcfExclude },\n          } = field;\n\n          if (/button|image|submit|reset/.test(type)) return false;\n          if (rcfExclude && !name) {\n            warn('💡 react-cool-form > field: Missing the \"name\" attribute.');\n            return false;\n          }\n\n          return (\n            controllersRef.current[name] ||\n            !(rcfExclude || excludeFieldsRef.current[name])\n          );\n        })\n        .reduce((acc: Record<string, any>, cur) => {\n          const field = cur as FieldElement;\n          const { name } = field;\n\n          acc[name] = { ...acc[name], field: cur };\n\n          if (isCheckboxInput(field) || isRadioInput(field))\n            acc[name].options = acc[name].options\n              ? [...acc[name].options, cur]\n              : [cur];\n\n          return acc;\n        }, {}),\n    []\n  );\n\n  const handleUnset = useCallback(\n    (path: string, fieldPath: string, target: any, name: string) =>\n      setStateRef(path, unset(target, name, true), { fieldPath }),\n    [setStateRef]\n  );\n\n  const fieldRef = useCallback<FieldRef<V>>(\n    (validateOrOptions) => (field) => {\n      if (\n        !field?.name ||\n        controllersRef.current[field.name] ||\n        excludeFieldsRef.current[field.name]\n      )\n        return;\n\n      if (isFunction(validateOrOptions)) {\n        fieldValidatorsRef.current[field.name] = validateOrOptions;\n        return;\n      }\n\n      const { validate: validator, ...parsers } = validateOrOptions;\n\n      if (validator) fieldValidatorsRef.current[field.name] = validator;\n      fieldArgsRef.current[field.name] = parsers;\n    },\n    []\n  );\n\n  const getNodeValue = useCallback(\n    (name: string) => {\n      const { field, options } = fieldsRef.current[name];\n      let value = field.value as any;\n\n      if (isInputElement(field)) {\n        if (fieldArgsRef.current[name]?.valueAsNumber) {\n          value = field.valueAsNumber;\n          return value;\n        }\n        if (fieldArgsRef.current[name]?.valueAsDate) {\n          value = field.valueAsDate;\n          return value;\n        }\n      }\n\n      if (isNumberInput(field) || isRangeInput(field))\n        value = field.valueAsNumber || \"\";\n\n      if (isCheckboxInput(field)) {\n        if (options) {\n          const checkboxes = options as HTMLInputElement[];\n\n          if (options.length > 1) {\n            value = checkboxes\n              .filter((checkbox) => checkbox.checked)\n              .map((checkbox) => checkbox.value);\n          } else {\n            value = checkboxes[0].checked;\n          }\n        } else {\n          let checkValues = get(stateRef.current.values, field.name);\n\n          if (Array.isArray(checkValues)) {\n            checkValues = new Set(checkValues);\n\n            if (field.checked) {\n              checkValues.add(value);\n            } else {\n              checkValues.delete(value);\n            }\n\n            value = Array.from(checkValues);\n          } else {\n            value = field.checked;\n          }\n        }\n      }\n\n      if (isRadioInput(field) && options)\n        value =\n          (options as HTMLInputElement[]).find((radio) => radio.checked)\n            ?.value || \"\";\n\n      if (isMultipleSelect(field) && !options)\n        value = Array.from(field.options)\n          .filter((option) => option.selected)\n          .map((option) => option.value);\n\n      if (isFileInput(field)) value = field.files;\n\n      return value;\n    },\n    [stateRef]\n  );\n\n  const setNodeValue = useCallback((name: string, value: any) => {\n    if (!fieldsRef.current[name] || controllersRef.current[name]) return;\n\n    const { field, options } = fieldsRef.current[name];\n\n    if (isCheckboxInput(field)) {\n      const checkboxes = options as HTMLInputElement[];\n\n      if (checkboxes.length > 1) {\n        checkboxes.forEach((checkbox) => {\n          checkbox.checked = Array.isArray(value)\n            ? value.includes(checkbox.value)\n            : !!value;\n        });\n      } else {\n        checkboxes[0].checked = !!value;\n      }\n    } else if (isRadioInput(field)) {\n      (options as HTMLInputElement[]).forEach((radio) => {\n        radio.checked = radio.value === value;\n      });\n    } else if (isMultipleSelect(field) && Array.isArray(value)) {\n      Array.from(field.options).forEach((option) => {\n        option.selected = !!value.includes(option.value);\n      });\n    } else if (isFileInput(field)) {\n      if (isFileList(value)) field.files = value;\n      if (!value) field.value = \"\";\n    } else {\n      field.value = value ?? \"\";\n    }\n  }, []);\n\n  const setDefaultValue = useCallback(\n    (name: string, value: any) => {\n      if (!isUndefined(get(initialStateRef.current.values, name))) return;\n\n      initialStateRef.current.values = set(\n        initialStateRef.current.values,\n        name,\n        value,\n        true\n      );\n\n      setStateRef(`values.${name}`, get(initialStateRef.current.values, name), {\n        shouldUpdate: !isInitRef.current,\n      });\n    },\n    [setStateRef]\n  );\n\n  const setNodesOrStateValue = useCallback(\n    (\n      values: V,\n      checkDefaultValues = false,\n      fields: FieldsValue[] | string[] = Object.values(fieldsRef.current)\n    ) =>\n      fields.forEach((field: FieldsValue | string) => {\n        const name = isPlainObject(field)\n          ? (field as FieldsValue).field.name\n          : field;\n\n        if (controllersRef.current[name]) return;\n\n        const value = get(values, name);\n\n        if (!isUndefined(value)) setNodeValue(name, value);\n\n        if (checkDefaultValues) {\n          const defaultValue = get(defaultValuesRef.current, name);\n\n          setDefaultValue(\n            name,\n            !isUndefined(defaultValue) ? defaultValue : getNodeValue(name)\n          );\n        }\n      }),\n    [getNodeValue, setDefaultValue, setNodeValue]\n  );\n\n  const getState = useCallback<GetState>(\n    (path, { target, watch = true, errorWithTouched = false } = {}) => {\n      if (!path) return undefined;\n\n      const getPath = (p: string) => {\n        if (p === \"values\" && !target && watch)\n          warn(\n            '💡 react-cool-form > getState: Get the \"values\" alone may cause unnecessary re-renders. If you know what you\\'re doing, please ignore this warning. See: https://react-cool-form.netlify.app/docs/getting-started/form-state#best-practices'\n          );\n\n        p = target ? `${target}.${p}` : p;\n\n        if (watch) setUsedStateRef(p);\n\n        return p;\n      };\n      const errorsEnhancer = (p: string, state: any) => {\n        if (\n          !watch ||\n          !errorWithTouched ||\n          !p.startsWith(\"errors\") ||\n          !state ||\n          isEmptyObject(state)\n        )\n          return state;\n\n        p = p.replace(\"errors\", \"touched\");\n        setUsedStateRef(p);\n\n        return filterErrors(state, get(stateRef.current, p));\n      };\n      let state;\n\n      if (Array.isArray(path)) {\n        state = path.map((p) => {\n          p = getPath(p);\n          return errorsEnhancer(p, get(stateRef.current, p));\n        });\n      } else if (isPlainObject(path)) {\n        const paths = path as Record<string, string>;\n        state = Object.keys(paths).reduce((s: Record<string, any>, key) => {\n          path = getPath(paths[key]);\n          s[key] = errorsEnhancer(path, get(stateRef.current, path));\n          return s;\n        }, {});\n      } else {\n        path = getPath(path);\n        state = errorsEnhancer(path, get(stateRef.current, path));\n      }\n\n      return state;\n    },\n    [setUsedStateRef, stateRef]\n  );\n\n  const setError = useCallback<SetError>(\n    (name, error) => {\n      error = isFunction(error)\n        ? error(get(stateRef.current.errors, name))\n        : error;\n\n      if (error) {\n        setStateRef(`errors.${name}`, error);\n      } else {\n        handleUnset(\"errors\", `errors.${name}`, stateRef.current.errors, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const clearErrors = useCallback<ClearErrors>(\n    (name) => {\n      if (!name) {\n        setStateRef(\"errors\", {});\n      } else if (Array.isArray(name)) {\n        name.forEach((n) =>\n          handleUnset(\"errors\", `errors.${n}`, stateRef.current.errors, n)\n        );\n      } else {\n        handleUnset(\"errors\", `errors.${name}`, stateRef.current.errors, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const runBuiltInValidation = useCallback(\n    (name: string) => {\n      if (builtInValidationMode === false || !fieldsRef.current[name])\n        return undefined;\n\n      const { field } = fieldsRef.current[name];\n\n      if (builtInValidationMode === \"message\") return field.validationMessage;\n\n      for (const k in field.validity) {\n        // @ts-expect-error\n        if (k !== \"valid\" && field.validity[k]) return k;\n      }\n\n      return undefined;\n    },\n    [builtInValidationMode]\n  );\n\n  const runAllBuiltInValidation = useCallback(() => {\n    if (builtInValidationMode === false) return {};\n\n    return Object.keys(fieldsRef.current).reduce((errors, name) => {\n      const error = runBuiltInValidation(name);\n      errors = { ...errors, ...(error ? set({}, name, error) : {}) };\n      return errors;\n    }, {});\n  }, [builtInValidationMode, runBuiltInValidation]);\n\n  const runFieldValidation = useCallback(\n    async (name: string): Promise<any> => {\n      if (!fieldValidatorsRef.current[name]) return undefined;\n\n      try {\n        const error = await fieldValidatorsRef.current[name](\n          get(stateRef.current.values, name),\n          stateRef.current.values\n        );\n\n        return error;\n      } catch (exception) {\n        warn(`💡 react-cool-form > validate ${name}: `, exception);\n        throw exception;\n      }\n    },\n    [stateRef]\n  );\n\n  const runAllFieldsValidation = useCallback((): Promise<FormErrors<V>> => {\n    const promises = Object.keys(fieldValidatorsRef.current).map((name) =>\n      runFieldValidation(name)\n    );\n\n    return Promise.all(promises).then((errors) =>\n      Object.keys(fieldValidatorsRef.current).reduce((acc, cur, idx) => {\n        acc = { ...acc, ...(errors[idx] ? set({}, cur, errors[idx]) : {}) };\n        return acc;\n      }, {})\n    );\n  }, [runFieldValidation]);\n\n  const runFormValidation = useCallback(\n    async (name?: string): Promise<any> => {\n      if (!formValidatorRef.current) return name ? undefined : {};\n\n      try {\n        const errors = await formValidatorRef.current(stateRef.current.values);\n\n        if (name) return get(errors, name);\n\n        return isPlainObject(errors) ? errors : {};\n      } catch (exception) {\n        warn(`💡 react-cool-form > validate form: `, exception);\n        throw exception;\n      }\n    },\n    [formValidatorRef, stateRef]\n  );\n\n  const validateField = useCallback(\n    async (name: string) => {\n      const hasAsyncValidator =\n        isAsyncFunction(formValidatorRef.current) ||\n        isAsyncFunction(fieldValidatorsRef.current[name]);\n\n      if (hasAsyncValidator) setStateRef(\"isValidating\", true);\n\n      try {\n        const error =\n          (await runFormValidation(name)) ||\n          (await runFieldValidation(name)) ||\n          runBuiltInValidation(name);\n\n        setError(name, error);\n        if (hasAsyncValidator) setStateRef(\"isValidating\", false);\n\n        return error;\n      } catch (exception) {\n        return exception;\n      }\n    },\n    [\n      formValidatorRef,\n      runBuiltInValidation,\n      runFieldValidation,\n      runFormValidation,\n      setError,\n      setStateRef,\n    ]\n  );\n\n  const validateFieldWithLowPriority = useCallback<typeof validateField>(\n    (name) => runWithLowPriority(() => validateField(name)),\n    [validateField]\n  );\n\n  const validateForm = useCallback((): Promise<FormErrors<V>> => {\n    setStateRef(\"isValidating\", true);\n\n    return Promise.all([\n      runAllBuiltInValidation(),\n      runAllFieldsValidation(),\n      runFormValidation(),\n    ]).then((errors) => {\n      const errs = deepMerge(...errors);\n\n      setStateRef(\"errors\", errs);\n      setStateRef(\"isValidating\", false);\n\n      return errs;\n    });\n  }, [\n    runAllBuiltInValidation,\n    runAllFieldsValidation,\n    runFormValidation,\n    setStateRef,\n  ]);\n\n  const runValidation = useCallback<RunValidation>(\n    (name) => {\n      if (!name) return validateForm().then((errors) => isEmptyObject(errors));\n\n      if (Array.isArray(name))\n        return Promise.all(name.map((n) => validateField(n))).then(\n          (errors) => !compact(errors).length\n        );\n\n      return validateField(name).then((error) => !error);\n    },\n    [validateField, validateForm]\n  );\n\n  const setTouched = useCallback<SetTouched>(\n    (name, isTouched = true, shouldValidate = validateOnBlur) => {\n      if (isTouched) {\n        setStateRef(`touched.${name}`, true);\n      } else {\n        handleUnset(\n          \"touched\",\n          `touched.${name}`,\n          stateRef.current.touched,\n          name\n        );\n      }\n\n      if (shouldValidate) validateFieldWithLowPriority(name);\n    },\n    [\n      handleUnset,\n      setStateRef,\n      stateRef,\n      validateFieldWithLowPriority,\n      validateOnBlur,\n    ]\n  );\n\n  const setTouchedMaybeValidate = useCallback(\n    (name: string) =>\n      setTouched(\n        name,\n        true,\n        validateOnChange ? name !== changedFieldRef.current : undefined\n      ),\n    [setTouched, validateOnChange]\n  );\n\n  const setDirty = useCallback<SetDirty>(\n    (name, isDirty = true) => {\n      if (isDirty) {\n        setStateRef(`dirty.${name}`, true);\n      } else {\n        handleUnset(\"dirty\", `dirty.${name}`, stateRef.current.dirty, name);\n      }\n    },\n    [handleUnset, setStateRef, stateRef]\n  );\n\n  const setDirtyIfNeeded = useCallback(\n    (name: string) =>\n      setDirty(\n        name,\n        get(stateRef.current.values, name) !==\n          get(initialStateRef.current.values, name)\n      ),\n    [setDirty, stateRef]\n  );\n\n  const setValue = useCallback<SetValue>(\n    (\n      name,\n      value,\n      {\n        shouldValidate = validateOnChange,\n        shouldTouched = true,\n        shouldDirty = true,\n      } = {}\n    ) => {\n      value = isFunction(value)\n        ? value(get(stateRef.current.values, name))\n        : value;\n\n      if (!isUndefined(value)) {\n        setStateRef(`values.${name}`, value);\n      } else {\n        handleUnset(\"values\", `values.${name}`, stateRef.current.values, name);\n      }\n      setNodeValue(name, value);\n\n      if (shouldTouched) setTouched(name, true, false);\n      if (shouldDirty) setDirtyIfNeeded(name);\n      if (shouldValidate) validateFieldWithLowPriority(name);\n    },\n    [\n      handleUnset,\n      setDirtyIfNeeded,\n      setNodeValue,\n      setStateRef,\n      setTouched,\n      stateRef,\n      validateFieldWithLowPriority,\n      validateOnChange,\n    ]\n  );\n\n  const getOptions = useCallback(\n    () => ({\n      formState: stateRef.current,\n      setValue,\n      setTouched,\n      setDirty,\n      setError,\n      clearErrors,\n      runValidation,\n      reset,\n      submit,\n    }),\n    [\n      clearErrors,\n      // @ts-expect-error\n      reset,\n      runValidation,\n      setDirty,\n      setError,\n      setTouched,\n      setValue,\n      stateRef,\n      // @ts-expect-error\n      submit,\n    ]\n  );\n\n  const reset: Reset<V> = useCallback(\n    (values, exclude, e) => {\n      e?.preventDefault();\n      e?.stopPropagation();\n\n      const state = { ...stateRef.current };\n      const skip = arrayToMap(exclude || []);\n\n      Object.keys(state).forEach((key) => {\n        if (skip[key]) return;\n\n        if (key === \"values\") {\n          const nextValues =\n            (isFunction(values) ? values(stateRef.current.values) : values) ||\n            initialStateRef.current.values;\n\n          state[key] = nextValues;\n          initialStateRef.current.values = nextValues;\n          setNodesOrStateValue(initialStateRef.current.values, !!values);\n        } else {\n          // @ts-expect-error\n          state[key] = initialStateRef.current[key];\n        }\n      });\n\n      setStateRef(\"\", state);\n      onResetRef.current(state.values, getOptions(), e);\n    },\n    [getOptions, onResetRef, setNodesOrStateValue, setStateRef, stateRef]\n  );\n\n  const submit: Submit<V> = useCallback(\n    async (e) => {\n      e?.preventDefault();\n      e?.stopPropagation();\n\n      const nextTouched = Object.keys({\n        ...fieldsRef.current,\n        ...controllersRef.current,\n      }).reduce((touched, name) => {\n        touched = set(touched, name, true, true);\n        return touched;\n      }, stateRef.current.touched);\n\n      setStateRef(\"touched\", nextTouched);\n      setStateRef(\"isSubmitting\", true);\n\n      try {\n        const errors = await validateForm();\n\n        if (!isEmptyObject(errors)) {\n          onErrorRef.current(errors, getOptions(), e);\n\n          return { errors };\n        }\n\n        await onSubmitRef.current(stateRef.current.values, getOptions(), e);\n        setStateRef(\"isSubmitted\", true);\n\n        return { values: stateRef.current.values };\n      } catch (exception) {\n        warn(`💡 react-cool-form > submit: `, exception);\n        throw exception;\n      } finally {\n        setStateRef(\"isSubmitting\", false);\n      }\n    },\n    [getOptions, onErrorRef, onSubmitRef, setStateRef, stateRef, validateForm]\n  );\n\n  const handleChangeEvent = useCallback(\n    (name: string, value: any) => {\n      setStateRef(`values.${name}`, value);\n      setDirtyIfNeeded(name);\n\n      if (validateOnChange) validateFieldWithLowPriority(name);\n    },\n    [\n      setDirtyIfNeeded,\n      setStateRef,\n      validateFieldWithLowPriority,\n      validateOnChange,\n    ]\n  );\n\n  const controller = useCallback<Controller<V>>(\n    (\n      name,\n      {\n        validate: validator,\n        value,\n        defaultValue,\n        parse,\n        format,\n        onChange,\n        onBlur,\n      } = {}\n    ) => {\n      if (!name) {\n        warn('💡 react-cool-form > controller: Missing the \"name\" parameter.');\n        return undefined;\n      }\n\n      controllersRef.current[name] = true;\n      if (validator) fieldValidatorsRef.current[name] = validator;\n\n      const val = get(defaultValuesRef.current, name);\n      defaultValue = !isUndefined(val) ? val : defaultValue;\n      if (!isUndefined(defaultValue)) setDefaultValue(name, defaultValue);\n\n      value = !isUndefined(value) ? value : getState(`values.${name}`);\n      value = (format ? format(value) : value) ?? \"\";\n\n      return {\n        name,\n        value,\n        onChange: (...args) => {\n          let v;\n\n          if (parse) {\n            v = parse(...args);\n          } else {\n            const e = args[0];\n            v =\n              e?.nativeEvent instanceof Event && isFieldElement(e.target)\n                ? getNodeValue(name)\n                : e;\n          }\n\n          handleChangeEvent(name, v);\n          if (onChange) onChange(...args, v);\n          changedFieldRef.current = name;\n        },\n        onBlur: (e) => {\n          setTouchedMaybeValidate(name);\n          if (onBlur) onBlur(e);\n          changedFieldRef.current = undefined;\n        },\n      };\n    },\n    [\n      getNodeValue,\n      getState,\n      handleChangeEvent,\n      setDefaultValue,\n      setTouchedMaybeValidate,\n    ]\n  );\n\n  useIsoLayoutEffect(() => {\n    if (!formRef.current) return;\n\n    fieldsRef.current = getFields(formRef.current);\n    setNodesOrStateValue(initialStateRef.current.values, true);\n    isInitRef.current = false;\n  }, [getFields, setNodesOrStateValue]);\n\n  useEffect(() => {\n    if (!formRef.current) return () => null;\n\n    const handleChange = ({ target }: Event) => {\n      const { name } = target as FieldElement;\n\n      if (!name) {\n        warn('💡 react-cool-form > field: Missing the \"name\" attribute.');\n        return;\n      }\n\n      if (fieldsRef.current[name] && !controllersRef.current[name]) {\n        const parse = fieldArgsRef.current[name]?.parse;\n        const value = getNodeValue(name);\n\n        handleChangeEvent(name, parse ? parse(value) : value);\n        changedFieldRef.current = name;\n      }\n    };\n\n    const handleBlur = ({ target }: Event) => {\n      if (!isFieldElement(target as HTMLElement)) return;\n\n      const { name } = target as FieldElement;\n\n      if (fieldsRef.current[name] && !controllersRef.current[name]) {\n        setTouchedMaybeValidate(name);\n        changedFieldRef.current = undefined;\n      }\n    };\n\n    const handleSubmit = (e: Event) => submit(e as any);\n\n    const handleReset = (e: Event) => reset(null, null, e as any);\n\n    const form = formRef.current;\n    form.addEventListener(\"input\", handleChange);\n    form.addEventListener(\"focusout\", handleBlur);\n    form.addEventListener(\"submit\", handleSubmit);\n    form.addEventListener(\"reset\", handleReset);\n\n    const observer = new MutationObserver(([{ type }]) => {\n      if (type !== \"childList\") return;\n\n      const fields = getFields(form);\n      let { values } = stateRef.current;\n\n      if (shouldRemoveField)\n        Object.keys(fieldsRef.current).forEach((name) => {\n          if (fields[name]) return;\n\n          handleUnset(\n            \"values\",\n            `values.${name}`,\n            stateRef.current.values,\n            name\n          );\n          handleUnset(\n            \"touched\",\n            `touched.${name}`,\n            stateRef.current.touched,\n            name\n          );\n          handleUnset(\"dirty\", `dirty.${name}`, stateRef.current.dirty, name);\n          handleUnset(\n            \"errors\",\n            `errors.${name}`,\n            stateRef.current.errors,\n            name\n          );\n          setUsedStateRef(name, true);\n\n          initialStateRef.current.values = unset(\n            initialStateRef.current.values,\n            name,\n            true\n          );\n          delete fieldArgsRef.current[name];\n          delete fieldValidatorsRef.current[name];\n          delete controllersRef.current[name];\n        });\n\n      const addedNodes: string[] = [];\n\n      Object.keys(fields).forEach((name) => {\n        if (fieldsRef.current[name] || controllersRef.current[name]) return;\n\n        const defaultValue = get(defaultValuesRef.current, name);\n\n        if (!isUndefined(defaultValue))\n          values = set(values, name, defaultValue, true);\n\n        addedNodes.push(name);\n      });\n\n      fieldsRef.current = fields;\n      if (addedNodes.length) setNodesOrStateValue(values, true, addedNodes);\n    });\n    observer.observe(form, { childList: true, subtree: true });\n\n    return () => {\n      form.removeEventListener(\"input\", handleChange);\n      form.removeEventListener(\"focusout\", handleBlur);\n      form.removeEventListener(\"submit\", handleSubmit);\n      form.removeEventListener(\"reset\", handleReset);\n      observer.disconnect();\n    };\n  }, [\n    getFields,\n    getNodeValue,\n    handleChangeEvent,\n    handleUnset,\n    reset,\n    setNodesOrStateValue,\n    setTouchedMaybeValidate,\n    setUsedStateRef,\n    shouldRemoveField,\n    stateRef,\n    submit,\n  ]);\n\n  return {\n    form: formRef,\n    field: fieldRef,\n    getState,\n    setValue,\n    setTouched,\n    setDirty,\n    setError,\n    clearErrors,\n    runValidation,\n    reset,\n    submit,\n    controller,\n  };\n};\n"],"names":["val","ref","useRef","useEffect","current","arr","reduce","obj","key","value","FileList","cloneObject","object","Event","Error","isObject","isFileList","Date","getTime","Array","isArray","map","Object","keys","filter","Boolean","deepMerge","objects","prev","forEach","prevValue","currValue","isPlainObject","undefined","filterErrors","error","touched","nextErrors","isUndefined","str","TypeError","length","compact","split","path","defaultValue","stringToPath","getIsDirty","dirty","search","dty","found","values","push","isFunction","constructor","name","field","type","element","test","tagName","callback","window","requestIdleCallback","cb","start","now","setTimeout","didTimeout","timeRemaining","Math","max","timeout","immutable","segs","newObject","slice","idx","nextIsNumber","Number","isNaN","refObject","hasOwnProperty","last","pop","target","__DEV__","console","warn","initialState","onChange","useReducer","c","forceUpdate","stateRef","usedStateRef","onChangeRef","useLatest","setStateRef","useCallback","fieldPath","shouldUpdate","dequal","get","state","set","errors","prevIsDirty","isDirty","prevIsValid","isValid","prevSubmitCount","submitCount","isEmptyObject","some","k","startsWith","setUsedStateRef","unset","useIsoLayoutEffect","useLayoutEffect","defaultValues","validate","validateOnChange","validateOnBlur","builtInValidationMode","shouldRemoveField","excludeFields","onReset","onSubmit","onError","debug","isInitRef","formRef","fieldsRef","fieldArgsRef","controllersRef","excludeFieldsRef","arrayToMap","changedFieldRef","formValidatorRef","fieldValidatorsRef","onResetRef","onSubmitRef","onErrorRef","defaultValuesRef","initialStateRef","isValidating","isSubmitting","isSubmitted","useState","getFields","form","from","querySelectorAll","rcfExclude","dataset","acc","cur","isCheckboxInput","isRadioInput","options","handleUnset","fieldRef","validateOrOptions","validator","parsers","getNodeValue","isInputElement","valueAsNumber","valueAsDate","isNumberInput","isRangeInput","checkboxes","checkbox","checked","checkValues","Set","add","find","radio","isMultipleSelect","option","selected","isFileInput","files","setNodeValue","includes","setDefaultValue","setNodesOrStateValue","checkDefaultValues","fields","getState","watch","errorWithTouched","getPath","p","errorsEnhancer","replace","paths","s","setError","clearErrors","n","runBuiltInValidation","validationMessage","validity","runAllBuiltInValidation","runFieldValidation","exception","runAllFieldsValidation","promises","Promise","all","then","runFormValidation","validateField","hasAsyncValidator","isAsyncFunction","validateFieldWithLowPriority","runWithLowPriority","validateForm","errs","runValidation","setTouched","isTouched","shouldValidate","setTouchedMaybeValidate","setDirty","setDirtyIfNeeded","setValue","shouldTouched","shouldDirty","getOptions","formState","reset","submit","exclude","e","preventDefault","stopPropagation","skip","nextValues","nextTouched","handleChangeEvent","controller","parse","format","onBlur","v","args","nativeEvent","isFieldElement","handleChange","handleBlur","handleSubmit","handleReset","addEventListener","observer","MutationObserver","addedNodes","observe","childList","subtree","removeEventListener","disconnect"],"mappings":"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"}